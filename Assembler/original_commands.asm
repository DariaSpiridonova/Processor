;----------------------------------------------------------------------------------------------------------
; Main function                                                                                           -
;----------------------------------------------------------------------------------------------------------
PRINT_RAM 
CALL :8 ; Get coefficients
CALL :12 ; Checking for a linear equation

CALL :1 ; Calculating the discriminant
CALL :2 ; Check the discriminant

CALL :10 ; Print number of roots

CALL :11 ; Print roots

HLT

;----------------------------------------------------------------------------------------------------------
; Print roots                                                                                             -
;----------------------------------------------------------------------------------------------------------
:11
PUSHM [BP]
PUSH 0
JE :12

SUB
PUSH 1
JE :13

SUB ; for 2 roots
PUSH 1
ADD
SQRT
POPR DX
PUSH -1
PUSHR BX
MUL
POPR BX
PUSHR BX
PUSHR DX
ADD
POPR CX
PUSHR BX
PUSHR DX
SUB
POPR DX
PUSHR CX
PUSH 2
PUSHR AX
MUL
DIV
OUT 

PUSHR DX
PUSH 2
PUSHR AX
MUL
DIV
OUT
RET

:12 ; for 0 roots
RET

:13 ; for 1 root
PUSH -1
PUSHR BX
MUL
PUSH 2
PUSHR AX
MUL
DIV
OUT
RET

;----------------------------------------------------------------------------------------------------------
; Checking for a linear equation                                                        -
;----------------------------------------------------------------------------------------------------------
:12
PUSHR AX
PUSH 0
JE :5 
RET

;----------------------------------------------------------------------------------------------------------
; Getting the coefficients of a quadratic equation                                                        -
;----------------------------------------------------------------------------------------------------------
:8
IN
IN
IN
POPR CX
POPR BX 
POPR AX
RET

;----------------------------------------------------------------------------------------------------------
; Print number of roots                                                                                   -
;----------------------------------------------------------------------------------------------------------
:10
PUSHM [BP]
OUT
RET

;----------------------------------------------------------------------------------------------------------
; Calculating the discriminant                                                                            -
;----------------------------------------------------------------------------------------------------------
:1
PUSHR BX
PUSHR BX
MUL
PUSHR AX
PUSHR CX
PUSH 4
MUL
MUL
SUB
RET


;***********************************************************************************************************
;----------------------------------------------------------------------------------------------------------
; Check the discriminant                                                                                  -
;----------------------------------------------------------------------------------------------------------
:2
PUSH 0
JA :3 ;--- if the discriminant is negative ---
JE :4 ;--- if the discriminant is equal to zero ---                                                                          - 
POPR BP ; For the positive discriminant
PUSH 2
POPM [BP] ; положили число 2 в оперативку [0]
RET

;----------------------------------------------------------------------------------------------------------
; For the negative discriminant                                                                           -
;----------------------------------------------------------------------------------------------------------
:3
PUSH 0
POPR BP
PUSH 0
POPM [BP] ; положили число 0 в оперативку [0]
RET

;----------------------------------------------------------------------------------------------------------
; For a discriminant equal to zero                                                                        -
;----------------------------------------------------------------------------------------------------------
:4
PUSH 0
POPR BP
PUSH 1
POPM [BP] ; положили число 1 в оперативку [0]
RET
;***********************************************************************************************************

;----------------------------------------------------------------------------------------------------------
; If a = 0                                                                                                -
;----------------------------------------------------------------------------------------------------------
:5
PUSHR BX
PUSH 0
JE :6
PUSH 1
OUT
PUSHR CX
PUSH -1
MUL
PUSHR BX
DIV
OUT
HLT

;----------------------------------------------------------------------------------------------------------
; If b = 0                                                                                                -
;----------------------------------------------------------------------------------------------------------
:6
PUSHR CX
PUSH 0
JE :7
PUSH 0
OUT 
HLT

;----------------------------------------------------------------------------------------------------------
; If c = 0                                                                                                -
;----------------------------------------------------------------------------------------------------------
:7
PUSH 8
OUT 
HLT